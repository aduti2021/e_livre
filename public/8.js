(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{89:function(t,a,e){"use strict";e.r(a);var n={mounted:function(){this.isMobile=window.innerWidth<600,this.remplirTableHistoriqueAbsence(),this.remplirTableHistoriqueFonds()},data:function(){return{expanded1:[],singleExpand1:!1,page1:1,pageCount1:0,itemsPerPage1:10,nb_page_abs:1,max_width_dialog:390,expanded2:[],lien_site:location.protocol+"//"+location.host,singleExpand2:!1,page2:1,pageCount2:0,nb_page_fonds:1,itemsPerPage2:10,dialog_mes_retr:!1,type_retour:"",isMobile:!1,loading_data:!0,message_retour:"",loadform:!1,absHeadersFonds:[{text:"Date",align:"start",sortable:!0,value:"date"},{text:"Fond Demandé (FCFA)",value:"total"},{text:"Statut",value:"statut"},{text:"",value:"data-table-expand"}],absHeaders:[{text:"Date de début",value:"date_debut"},{text:"Date de fin",value:"date_fin"},{text:"Nombre de jour",value:"nb_jr"},{text:"Statut",value:"statut"},{text:"",value:"data-table-expand"}],data_autorisation:[],data_fonds:[]}},methods:{clicked:function(t){this.expanded1.push(t)},clicked2:function(t){this.expanded2.push(t)},remplirTableHistoriqueAbsence:function(){this.loading_data=!0;var t=this;axios.post("/historique/autorisation?page="+this.page1).then((function(a){var e=a.data.data.data;t.nb_page_abs=a.data.data.last_page,t.data_autorisation=[],Object.keys(e).forEach((function(a,n){var i={id:0,raison_abs:"",compensation:"",reponse:"",date_debut:"",email:"",date_fin:"",nb_jr:""};i.id=e[n].id,i.raison_abs=e[n].raison_abs,i.compensation=e[n].compensation,i.statut=e[n].statut,i.date_debut=e[n].date_debut,i.date_fin=e[n].date_fin,i.reponse=e[n].mot_retour;var s=new Date(e[n].date_debut),o=new Date(e[n].date_fin).getTime()-s.getTime();i.nb_jr=o/864e5,t.data_autorisation.push(i)})),t.data_autorisation.forEach((function(a,e){switch(a.statut){case 0:t.data_autorisation[e].statut="En attente";break;case 1:t.data_autorisation[e].statut="Accordée";break;case 2:t.data_autorisation[e].statut="Rejetée"}})),t.loading_data=!1})).catch((function(t){}))},imprimerFiche:function(t){window.open(this.lien_site+"/fichier_pdf_demande_fonds/"+t,"_blank")},imprimerFicheAbsence:function(t){window.open(this.lien_site+"/fichier_pdf_autorisation_abs/"+t,"_blank")},remplirTableHistoriqueFonds:function(){this.loading_data=!0;var t=this;axios.post("/historique/fonds?page="+this.page2).then((function(a){var e=a.data.data.data;t.nb_page_fonds=a.data.data.last_page,t.data_fonds=[],Object.assign(t.data_fonds,e),t.data_fonds.forEach((function(a,e){var n=0;t.data_fonds[e].data=JSON.parse(a.data),a.data.forEach((function(t,a){n+=t.total})),t.data_fonds[e].total=n})),t.data_fonds.forEach((function(a,e){switch(a.statut){case 0:t.data_fonds[e].statut="En attente";break;case 1:t.data_fonds[e].statut="Accordée";break;case 2:t.data_fonds[e].statut="Rejetée"}})),t.loading_data=!1})).catch((function(t){}))},getColor:function(t){switch(t){case"En attente":return"orange";case"Accordée":return"green";case"Rejetée":return"red"}},getItem:function(t){var a=this,e=0;return Object.keys(this.data_autorisation).forEach((function(n){e=0,a.data_autorisation[n].id===t&&(e=n)})),e}}},i=e(1),s=Object(i.a)(n,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("v-card",{staticClass:"mt-3"},[e("v-toolbar",{attrs:{flat:"",dark:"",color:"primary"}},[e("v-toolbar-title",[t._v("Historique des autorisations  d'absence et demande de Fonds")])],1),t._v(" "),e("v-tabs",{attrs:{vertical:!t.isMobile}},[e("v-tab",[e("v-icon",{attrs:{left:""}},[t._v("\n                        mdi-account-remove\n                    ")]),t._v("\n                    Absences\n                ")],1),t._v(" "),e("v-tab",[e("v-icon",{attrs:{left:""}},[t._v("\n                        fa-money\n                    ")]),t._v("\n                    Fonds\n                ")],1),t._v(" "),e("v-tab-item",[e("v-card",{attrs:{flat:""}},[t.loading_data?e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card"}}):t._e(),t._v(" "),t.loading_data?t._e():e("div",{staticClass:"mt-3"},[e("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.absHeaders,items:t.data_autorisation,"single-expand":"",expanded:t.expanded1,"item-key":"id","hide-default-footer":"",page:t.page1,"show-expand":""},on:{"update:expanded":function(a){t.expanded1=a},"click:row":t.clicked,"update:page":function(a){t.page1=a}},scopedSlots:t._u([{key:"top",fn:function(){return[e("v-toolbar",{attrs:{flat:""}},[e("v-toolbar-title"),t._v(" "),e("v-spacer")],1)]},proxy:!0},{key:"expanded-item",fn:function(a){var n=a.headers,i=a.item;return[e("td",{attrs:{colspan:n.length}},[e("p",{staticClass:"subtitle-1"},[t._v(" Raison de l'absence : ("),e("b",[t._v(t._s(i.raison_abs)+" ")]),t._v("  )."),e("br"),t._v(" "),e("v-divider"),t._v("\n                                            Réponse à la demande : (  "),e("b",[t._v(" "+t._s(i.reponse)+" ")]),t._v(" )."),e("br")],1),t._v(" "),e("v-divider"),t._v(" "),e("v-btn",{staticClass:"mt-2 ma-2",attrs:{color:"primary"},on:{click:function(a){return t.imprimerFicheAbsence(i.id)}}},[e("v-icon",[t._v("mdi-printer")]),t._v(" Imprimer la demande\n                                        ")],1)],1)]}},{key:"no-data",fn:function(){return[e("p",{staticClass:"subtitle-1"},[t._v("Aucune donnée disponible")])]},proxy:!0},{key:"item.statut",fn:function(a){var n=a.item;return[e("v-chip",{attrs:{color:t.getColor(n.statut),dark:""}},[t._v("\n\n                                        "+t._s(n.statut)+"\n                                    ")])]}}],null,!1,1706095361)}),t._v(" "),t.nb_page_abs>1?e("v-row",{attrs:{justify:"center"}},[e("v-col",{attrs:{cols:"8"}},[e("v-container",{staticClass:"max-width"},[e("v-pagination",{staticClass:"my-4",attrs:{length:t.nb_page_abs},on:{input:t.remplirTableHistoriqueAbsence},model:{value:t.page1,callback:function(a){t.page1=a},expression:"page1"}})],1)],1)],1):t._e()],1)],1)],1),t._v(" "),e("v-tab-item",[e("v-card",{attrs:{flat:""}},[e("v-card-text",[t.loading_data?e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card"}}):t._e(),t._v(" "),t.loading_data?t._e():e("div",{staticClass:"mt-3"},[e("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.absHeadersFonds,items:t.data_fonds,"single-expand":"",expanded:t.expanded2,"item-key":"id","hide-default-footer":"",page:t.page2,"show-expand":""},on:{"update:expanded":function(a){t.expanded2=a},"click:row":t.clicked2,"update:page":function(a){t.page2=a}},scopedSlots:t._u([{key:"top",fn:function(){return[e("v-toolbar",{attrs:{flat:""}},[e("v-toolbar-title"),t._v(" "),e("v-spacer")],1)]},proxy:!0},{key:"expanded-item",fn:function(a){var n=a.headers,i=a.item;return[e("td",{attrs:{colspan:n.length}},[e("v-simple-table",[[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v("\n                                                            Désignation\n                                                        ")]),t._v(" "),e("th",{staticClass:"text-left"},[t._v("\n                                                            Quantité\n                                                        ")]),t._v(" "),e("th",{staticClass:"text-left"},[t._v("\n                                                            Prix Unitaire\n                                                        ")]),t._v(" "),e("th",{staticClass:"text-left"},[t._v("\n                                                            Total\n                                                        ")])])]),t._v(" "),e("tbody",t._l(i.data,(function(a){return e("tr",{key:i.name},[e("td",[t._v(t._s(a.name))]),t._v(" "),e("td",[t._v(t._s(a.quantite))]),t._v(" "),e("td",[t._v(t._s(a.prix_init))]),t._v(" "),e("td",[t._v(t._s(a.total))])])})),0)],t._v(" "),e("v-divider"),t._v(" "),e("p",{staticClass:"subtitle-1"},[t._v(" Raison de la demande : ("),e("b",[t._v(t._s(i.cause)+" ")]),t._v("  )."),e("br"),t._v(" "),e("v-divider"),t._v("\n                                                    Réponse de la demande : (  "),e("b",[t._v(" "+t._s(i.mot_retour)+" ")]),t._v(" )."),e("br"),t._v(" "),e("v-divider"),t._v(" "),e("v-btn",{staticClass:"mt-2 ma-2",attrs:{color:"primary"},on:{click:function(a){return t.imprimerFiche(i.id)}}},[e("v-icon",[t._v("mdi-printer")]),t._v(" Imprimer la demande\n                                                    ")],1)],1)],2)],1)]}},{key:"item.statut",fn:function(a){var n=a.item;return[e("v-chip",{attrs:{color:t.getColor(n.statut),dark:""}},[t._v("\n\n                                            "+t._s(n.statut)+"\n                                        ")])]}},{key:"no-data",fn:function(){return[e("p",{staticClass:"subtitle-1"},[t._v("Aucune donnée disponible")])]},proxy:!0}],null,!1,3398433021)}),t._v(" "),t.nb_page_fonds>1?e("v-row",{attrs:{justify:"center"}},[e("v-col",{attrs:{cols:"8"}},[e("v-container",{staticClass:"max-width"},[e("v-pagination",{staticClass:"my-4",attrs:{length:t.nb_page_fonds},on:{input:t.remplirTableHistoriqueFonds},model:{value:t.page2,callback:function(a){t.page2=a},expression:"page2"}})],1)],1)],1):t._e()],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);a.default=s.exports}}]);